FROM node:18-alpine

WORKDIR /usr/src/node-red

# Copy package files first for better cache layering
COPY node-red/package*.json ./
RUN npm ci --only=production

# Copy Node-RED source
COPY node-red/ ./

EXPOSE 1880
CMD ["node", "start-nodered.js"]